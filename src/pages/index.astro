---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
---

<!doctype html>
<html lang="sv">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<div class="hero">
				<h1 class="main-h1">Välkommen till <br> Onlineföreningen SGC!</h1>
			</div>
			<img src="/narcon.webp" alt="Gruppbild på glada SGC-medlemmar utomhus i grönskan" class="logo" />
			<p>
				Vi är en medlemssdriven, HBTQ-vänlig förening och digitalt forum för ungdomar.
				Vi hänger främst på vår Discord som är öppen för alla! Med stöd av Sverok.
			</p>
			<p>
			Detta är vår hemsida där ni kan hitta information om våra event (digitala och fysiska) på vår <a href="/calender">kalender</a>,
			om våra spelservrar under <a href="/servers">servrar</a>, och om vår förening i allmänhet på <a href="/about">om oss</a>.
			Om du är förälder till ett barn som hänger i SGC och vill veta mer om oss, besök gärna vår flik <a href="/parents"> för föräldrar</a>.
			Vill du få reda på vilken level någon medlem av discorden är? Besök <a href="/member"> discord-medlemssidan</a>.
			</p>
			<div class="join-us">
				<button class="btn">
					<img src="/Discord.svg" width="30px"></img>
					<a href="https://discord.sgc.se" target="_blank">Gå med i vår Discord</a>
				</button>
				<button class="btn">
					<img class="sverok-icon" src="/sverok.svg" width="30px" ></img>
					<a href="https://blimedlem.sgc.se" target="_blank">Gå med i vår förening helt gratis!</a>
				</button>
			</div>

			<h2 class="news">
				Senaste nytt!
			</h2>
			<p>
				Den 1-7 december sker Musikhjälpen 2025 i Karlstad. Onlineföreningen SGC samlar åter igen in pengar till Musikhjälpen! 
				2024 samlade vi in 11.000kr, och nu är det dags igen! Pytsa för att få oss att göra utmaningar för er underhållning, 
				eller för att låsa upp någon gåva på vår discord. <br><a href="https://musikhjalpen.sgc.se">Klicka här för att komma till bössan!</a>
			</p>
			<div class="donation-progress">
                <h3>Musikhjälpen 2025 - Insamlingsmål</h3>
                <div class="progress-info">
                    <span id="current-amount">Laddar...</span>
                    <span id="goal-amount">Mål: 15.000kr</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-percentage" id="progress-percentage">0%</div>
                </div>
            </div>
		</main>
		<Footer />
		<script type="module">
            async function updateProgressBar() {
                try {
                    const response = await fetch('https://musikapi.lukasabbe.com/api/collection/sgc-musikhjaelpen');
                    const data = await response.json();

                    const currentAmount = data.amount || 0;
                    const goalAmount = data.goal || 15000;
                    
                    const percentage = Math.min((currentAmount / goalAmount) * 100, 100);
                    
                    document.getElementById('current-amount').textContent = `${currentAmount.toLocaleString('sv-SE')}kr`;
                    document.getElementById('goal-amount').textContent = `Mål: ${goalAmount.toLocaleString('sv-SE')}kr`;
                    document.getElementById('progress-fill').style.width = `${percentage}%`;
                    document.getElementById('progress-percentage').textContent = `${Math.round(percentage)}%`;
                    
                } catch (error) {
                    console.error('Kunde inte ladda progress data:', error);
                    document.getElementById('current-amount').textContent = 'Kunde inte ladda data';
                }
            }
            
            updateProgressBar();
            
            setInterval(updateProgressBar, 5 * 60 * 1000);
        </script>
	</body>
</html>
